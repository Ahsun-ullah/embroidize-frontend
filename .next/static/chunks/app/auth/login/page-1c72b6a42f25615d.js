(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4859],{7828:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(95155),s=r(72495),o=r(85087),l=r(57383),i=r(35695),n=r(12115);function c(e){let{showThankYou:t=!0}=e,r=(0,i.useRouter)(),c=(0,i.useSearchParams)().get("pathName")||"/",d=(0,n.useRef)(null),u=(0,n.useRef)(null),[m]=(0,o.cc)(),[p]=(0,o.b$)(),[h,g]=(0,n.useState)(!1),x=(e,t)=>new Promise((r,a)=>{if(document.getElementById(t))return r();let s=document.createElement("script");s.src=e,s.id=t,s.async=!0,s.onload=()=>r(),s.onerror=()=>a("Failed to load ".concat(t)),document.body.appendChild(s)});return(0,n.useEffect)(()=>{let e=!0,a=async()=>{try{if(await x("https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js","apple-client-script"),!e||!window.AppleID||!u.current)return;let a="com.yourcompany.app",o="https://embroidize.com/auth/apple/callback";if(!a||!o)return void console.error("Apple Client ID or Redirect URI not defined");window.AppleID.auth.init({clientId:a,redirectURI:o,scope:"email name",usePopup:!0}),u.current.innerHTML='\n          <appleid-signin\n            id="appleid-signin"\n            color="black"\n            type="sign in"\n            locale="en_US"\n            height="40"\n            width="300">\n          </appleid-signin>\n        ',window.addEventListener("AppleIDSignInOnSuccess",async e=>{g(!0);try{let a=await p({idToken:e.detail.authorization.id_token}).unwrap();l.A.set("token",a.data.token),t?r.push("/auth/thank-you?redirect=".concat(encodeURIComponent(c),"&email=").concat(encodeURIComponent(a.data.email),"&new_user=").concat(a.data.isNew)):"admin"===a.data.role?r.push("/admin"):r.push(c||"/")}catch(e){(0,s.Q)("Error","Apple login failed",3e3),g(!1)}}),window.addEventListener("AppleIDSignInOnFailure",e=>{console.error("Apple Sign In failed",e),(0,s.Q)("Error","Apple login failed",3e3)})}catch(e){console.error(e),(0,s.Q)("Error","Failed to load Apple login",3e3)}};return(async()=>{try{if(await x("https://accounts.google.com/gsi/client","google-client-script"),!e||!window.google||!d.current)return;let a="989558725966-tdnjrfjdi7kqr69u13hj5p69i85voj98.apps.googleusercontent.com";if(!a)return void console.error("Google Client ID not defined");window.google.accounts.id.initialize({client_id:a,callback:async e=>{g(!0);try{let a=await m({idToken:e.credential}).unwrap();l.A.set("token",a.data.token),t?r.push("/auth/thank-you?redirect=".concat(encodeURIComponent(c),"&email=").concat(encodeURIComponent(a.data.email),"&new_user=").concat(a.data.isNew)):"admin"===a.data.role?r.push("/admin"):r.push(c||"/")}catch(e){(0,s.Q)("Error","Google login failed",3e3),g(!1)}}}),window.google.accounts.id.renderButton(d.current,{theme:"outline",size:"large",width:300})}catch(e){console.error(e),(0,s.Q)("Error","Failed to load Google login",3e3)}})(),a(),()=>{e=!1}},[m,p,c,r,t]),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[h&&(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Processing, please wait..."})}),(0,a.jsx)("div",{ref:d,className:"flex justify-center ".concat(h?"opacity-40 pointer-events-none":"")}),(0,a.jsx)("div",{ref:u,className:"flex justify-center ".concat(h?"opacity-40 pointer-events-none":"")})]})}},29879:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(95155),s=r(9234);let o=()=>(0,a.jsx)(s.o,{color:"white",className:"bg-black p-3 rounded-full"})},35695:(e,t,r)=>{"use strict";r.r(t);var a=r(18999),s={};for(let e in a)"default"!==e&&(s[e]=()=>a[e]);r.d(t,s)},44638:(e,t,r)=>{Promise.resolve().then(r.bind(r,70985))},45845:(e,t,r)=>{"use strict";r.d(t,{Gq:()=>l,Hd:()=>i,Lv:()=>m,jm:()=>c,nd:()=>u,xM:()=>n,zo:()=>d});var a=r(70404),s=r(76698),o=r(57383);let l=(0,a.xP)({reducerPath:"userInfoSlice",baseQuery:(0,s.cw)({baseUrl:"https://api.embroidize.com/api/v1",prepareHeaders:e=>{let t=o.A.get("token");return t&&e.set("Authorization","Bearer ".concat(t)),e}}),endpoints:e=>({userInfo:e.query({query:()=>({url:"/userinfo",method:"GET"})}),updateUserInfo:e.mutation({query:e=>({url:"/user/".concat(e.get("id")),method:"PUT",body:e})}),updatePassword:e.mutation({query:e=>({url:"/settings/password/",method:"PATCH",body:e})}),forgotPassword:e.mutation({query:e=>({url:"/public/forgot-password",method:"POST",body:e})}),resetPassword:e.mutation({query:e=>({url:"/public/reset-password",method:"POST",body:e})}),UserDownloadHistory:e.query({query:e=>({url:"/downloads/user/".concat(e),method:"GET"})})})}),{useUserInfoQuery:i,useUpdateUserInfoMutation:n,useUserDownloadHistoryQuery:c,useUpdatePasswordMutation:d,useForgotPasswordMutation:u,useResetPasswordMutation:m}=l},53454:(e,t,r)=>{"use strict";r.d(t,{r:()=>l});var a=r(95155),s=r(60418),o=r(29858);let l=(e,t,r)=>(0,s.$U)({title:"".concat(e,"!"),description:"".concat(t),timeout:"".concat(r),color:"success",position:"top-right",shouldShowTimeoutProgress:!0,classNames:{closeButton:"opacity-100 absolute right-4 top-1/2 -translate-y-1/2 ms-8",base:(0,o.cn)(["bg-default-50 dark:bg-background shadow-sm text-black flex"])},closeIcon:(0,a.jsxs)("svg",{fill:"none",height:"32",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"32",children:[(0,a.jsx)("path",{d:"M18 6 6 18"}),(0,a.jsx)("path",{d:"m6 6 12 12"})]})})},70985:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>k});var a=r(95155),s=r(7828),o=r(72495),l=r(94891),i=r(45845),n=r(90221),c=r(12115),d=r(62177),u=r(70927),m=r(29879),p=r(53454);let h=u.Ik({email:u.Yj().email("Please enter a valid email address")}),g=c.memo(function(e){let{isOpen:t,onClose:r}=e,{register:s,handleSubmit:o,formState:{errors:u,isDirty:g},reset:x}=(0,d.mN)({resolver:(0,n.u)(h),defaultValues:{email:""}}),[b,f]=(0,c.useState)(!1),[w,{isLoading:y}]=(0,i.nd)(),v=async e=>{try{let t=await w(e).unwrap();(0,p.r)("Success",(null==t?void 0:t.message)||"Reset link sent!",4e3),f(!0),x()}catch(e){(0,l.h)(e,"Failed to send reset link")}};return t?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",role:"dialog","aria-modal":"true","aria-labelledby":"forgot-password-title",children:(0,a.jsxs)("div",{className:"bg-white w-full max-w-md p-6 rounded-lg relative shadow-lg",children:[(0,a.jsx)("button",{onClick:()=>{f(!1),x(),r()},className:"absolute top-3 right-3 text-gray-500 hover:text-black text-xl","aria-label":"Close dialog",children:(0,a.jsx)("i",{className:"ri-close-fill text-2xl"})}),(0,a.jsx)("h2",{id:"forgot-password-title",className:"text-2xl font-bold mb-6 text-center",children:"Forgot Password"}),b?(0,a.jsx)("p",{className:"text-green-600 text-sm mb-4 text-center",children:"If your email is registered, a reset link will be sent shortly."}):(0,a.jsxs)("form",{onSubmit:o(v),children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block font-medium mb-1",htmlFor:"email",children:"Email Address"}),(0,a.jsx)("input",{type:"email",id:"email",...s("email"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your email","aria-required":"true","aria-invalid":u.email?"true":"false"}),u.email&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",role:"alert",children:u.email.message})]}),(0,a.jsx)("button",{type:"submit",disabled:y||!g,className:"w-full h-10 font-semibold rounded-md transition ".concat(y||!g?"bg-gray-400 cursor-not-allowed":"bg-black text-white hover:bg-blue-500"),children:y?(0,a.jsx)(m.default,{}):"Send Reset Link"})]})]})}):null});var x=r(85087),b=r(78355),f=r(57383),w=r(66766),y=r(6874),v=r.n(y),j=r(35695);let k=()=>{let e=(0,j.useRouter)(),[t,r]=(0,c.useState)(!1),l=(0,j.useSearchParams)(),[i,{isLoading:n}]=(0,x.Yi)(),d=l.get("pathName"),u=async t=>{var r,a,s;t.preventDefault();let l=new FormData(t.target),n=null==(r=l.get("email"))?void 0:r.toString().trim().toLowerCase(),c=null!=(s=null==(a=l.get("password"))?void 0:a.toString())?s:"";if(!n||!c)return(0,o.Q)("Error","Email and password are required",3e3);try{let t=await i({email:n,password:c});t.error?(0,o.Q)("Error",t.error.data.message||"Login failed",3e3):((0,p.r)("Success",t.data.message||"Login successful!",3e3),f.A.set("token",t.data.data.token),"admin"===t.data.data.role?e.push("/admin"):e.push(d||"/"))}catch(e){(0,o.Q)("Error",e.message||"Something went wrong",3e3)}};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex flex-col h-screen items-center justify-center gap-10 px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"w-full max-w-md p-6 sm:w-3/4 md:w-2/3 lg:w-1/2 xl:w-1/3 border border-slate-400 rounded-3xl",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{children:(0,a.jsx)(v(),{href:"/",prefetch:!1,className:"relative block","aria-label":"Navigate to homepage",children:(0,a.jsx)(w.default,{src:"/logo-black.png",alt:"Company Logo",priority:!0,height:150,width:150})})}),(0,a.jsx)("p",{className:"text-base font-semibold mb-4 text-center",children:"Sign in to continue to Embroidize."})]}),(0,a.jsxs)("div",{className:"overflow-visible pb-2",children:[(0,a.jsxs)("form",{onSubmit:u,className:"pb-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email"}),(0,a.jsx)(b.r,{type:"email",name:"email",className:"form-control mt-2",placeholder:"Enter your email",required:!0})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{htmlFor:"password-input",className:"form-label",children:"Password"}),(0,a.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),r(!0)},type:"button",className:"text-sm text-black hover:underline",children:"Forgot Password?"})]}),(0,a.jsx)(b.r,{type:"password",name:"password",className:"form-control password-input mt-2",placeholder:"Enter password",required:!0})]}),(0,a.jsx)("div",{className:"w-full flex items-center justify-center",children:n?(0,a.jsx)(m.default,{}):(0,a.jsx)("input",{type:"submit",value:"Login",style:{borderRadius:"20px"},className:"button hover:bg-blue-500 text-white hover:text-white w-full h-10"})})]}),(0,a.jsx)(s.A,{showThankYou:!1}),(0,a.jsx)("div",{className:"mt-5 text-center",children:(0,a.jsxs)("p",{className:"mb-0",children:["Don't have an account?",(0,a.jsx)(v(),{href:d?"/auth/register?pathName=".concat(d):"/auth/register",prefetch:!1,className:"font-semibold ml-1 text-blue-500 underline",children:"Register"})]})}),(0,a.jsx)(g,{isOpen:t,onClose:()=>r(!1)})]})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"mb-0",children:["\xa9 ",new Date().getFullYear()," Embroidize."]})})]})})}},72495:(e,t,r)=>{"use strict";r.d(t,{Q:()=>l});var a=r(95155),s=r(60418),o=r(29858);let l=(e,t,r)=>(0,s.$U)({title:"".concat(e,"!"),description:"".concat(t),timeout:"".concat(r||3e3),color:"danger",position:"top-right",shouldShowTimeoutProgress:!0,classNames:{closeButton:"opacity-100 absolute right-4 top-1/2 -translate-y-1/2 ms-8",base:(0,o.cn)(["bg-default-50 dark:bg-background shadow-sm text-black flex"])},closeIcon:(0,a.jsxs)("svg",{fill:"none",height:"32",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"32",children:[(0,a.jsx)("path",{d:"M18 6 6 18"}),(0,a.jsx)("path",{d:"m6 6 12 12"})]})})},85087:(e,t,r)=>{"use strict";r.d(t,{RJ:()=>l,Yi:()=>i,b$:()=>h,cc:()=>p,dZ:()=>u,hU:()=>n,x8:()=>m});var a=r(70404),s=r(76698),o=r(57383);let l=(0,a.xP)({reducerPath:"authSlice",baseQuery:(0,s.cw)({baseUrl:"".concat("https://api.embroidize.com/api/v1"),prepareHeaders:e=>{let t=o.A.get("token");return t&&e.set("authorization","Bearer ".concat(t)),e}}),endpoints:e=>({userRegister:e.mutation({query:e=>({url:"/public/register",method:"POST",body:e})}),generateOtp:e.mutation({query:e=>({url:"/public/otp",method:"POST",body:e})}),verifyOtp:e.mutation({query:e=>({url:"/public/otp/verify",method:"POST",body:e})}),logIn:e.mutation({query:e=>({url:"/public/login",method:"POST",body:e})}),googleAuth:e.mutation({query:e=>({url:"/public/auth/google",method:"POST",body:e})}),appleAuth:e.mutation({query:e=>({url:"/auth/apple",method:"POST",body:e})}),forgetPassword:e.mutation({query:e=>({url:"/forgot-password",method:"POST",body:e})}),resetPassword:e.mutation({query:e=>({url:"/reset-password",method:"POST",body:e})})})}),{useLogInMutation:i,useUserRegisterMutation:n,useForgetPasswordMutation:c,useResetPasswordMutation:d,useGenerateOtpMutation:u,useVerifyOtpMutation:m,useGoogleAuthMutation:p,useAppleAuthMutation:h}=l},94891:(e,t,r)=>{"use strict";r.d(t,{h:()=>o});var a=r(72495);let s={"User already exists":"A user with this email already exists.","Invalid credentials":"The email or password you entered is incorrect.","OTP expired":"The OTP has expired. Please request a new one.","Invalid OTP":"The OTP you entered is incorrect."},o=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"An unexpected error occurred.",o=s[(null==e||null==(t=e.data)?void 0:t.message)||(null==e?void 0:e.message)||r]||r;(0,a.Q)("Error",o,3e3)}}},e=>{e.O(0,[9234,640,8355,4710,5014,6874,6766,6501,418,9858,9683,8441,5964,7358],()=>e(e.s=44638)),_N_E=e.O()}]);