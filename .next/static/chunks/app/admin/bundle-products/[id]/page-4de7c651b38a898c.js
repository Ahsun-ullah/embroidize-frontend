(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3572],{8574:(e,s,t)=>{"use strict";function a(e){return e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():""}t.d(s,{Ll:()=>l,Yv:()=>n,ZH:()=>a,ZV:()=>i});let l=async e=>{if("string"==typeof e&&e.startsWith("http"))try{let s=await fetch(e),t=await s.blob(),a=e.split("/").pop(),l=e.split(".").pop();return new File([t],a,{type:"application/".concat(l)})}catch(e){return console.error("Error fetching file from URL:",e),null}return e instanceof File||e instanceof Blob?e:null},n=e=>null==e?void 0:e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+|-+$/g,"");function i(e){return e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K":e.toString()}},47332:(e,s,t)=>{Promise.resolve().then(t.bind(t,73291))},53454:(e,s,t)=>{"use strict";t.d(s,{r:()=>i});var a=t(95155),l=t(60418),n=t(29858);let i=(e,s,t)=>(0,l.$U)({title:"".concat(e,"!"),description:"".concat(s),timeout:"".concat(t),color:"success",position:"top-right",shouldShowTimeoutProgress:!0,classNames:{closeButton:"opacity-100 absolute right-4 top-1/2 -translate-y-1/2 ms-8",base:(0,n.cn)(["bg-default-50 dark:bg-background shadow-sm text-black flex"])},closeIcon:(0,a.jsxs)("svg",{fill:"none",height:"32",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"32",children:[(0,a.jsx)("path",{d:"M18 6 6 18"}),(0,a.jsx)("path",{d:"m6 6 12 12"})]})})},72495:(e,s,t)=>{"use strict";t.d(s,{Q:()=>i});var a=t(95155),l=t(60418),n=t(29858);let i=(e,s,t)=>(0,l.$U)({title:"".concat(e,"!"),description:"".concat(s),timeout:"".concat(t||3e3),color:"danger",position:"top-right",shouldShowTimeoutProgress:!0,classNames:{closeButton:"opacity-100 absolute right-4 top-1/2 -translate-y-1/2 ms-8",base:(0,n.cn)(["bg-default-50 dark:bg-background shadow-sm text-black flex"])},closeIcon:(0,a.jsxs)("svg",{fill:"none",height:"32",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"32",children:[(0,a.jsx)("path",{d:"M18 6 6 18"}),(0,a.jsx)("path",{d:"m6 6 12 12"})]})})},73291:(e,s,t)=>{"use strict";t.d(s,{default:()=>P});var a=t(95155),l=t(8574),n=t(64915),i=t(40477),r=t(84520),c=t(1493),o=t(78355),d=t(98227),u=t(97376),m=t(64165),h=t(12115);let x=e=>{let{isOpen:s,onClose:t,onSubmit:x,initialData:p=null,isLoading:g=!1,selectedCount:j=0}=e,[f,b]=(0,h.useState)({name:"",slug:"",meta_title:"",meta_description:"",image:null}),[v,y]=(0,h.useState)("");return(0,h.useEffect)(()=>{if(p){var e;b({name:p.name||"",slug:p.slug||"",meta_title:p.meta_title||"",meta_description:p.meta_description||"",image:null}),y((null==(e=p.image)?void 0:e.url)||"")}else b({name:"",slug:"",meta_title:"",meta_description:"",image:null}),y("")},[p,s]),(0,a.jsx)(n.Y,{isOpen:s,onClose:t,size:"3xl",backdrop:"blur",scrollBehavior:"inside",children:(0,a.jsxs)(i.g,{children:[(0,a.jsx)(r.c,{className:"flex flex-col gap-1",children:p?"Update Bundle Design":"Create Bundle Design"}),(0,a.jsx)(c.h,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[!p&&(0,a.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg text-sm text-blue-700",children:["Creating bundle with ",j," product",j>1?"s":""]}),(0,a.jsx)(o.r,{label:"Bundle Name",placeholder:"Enter bundle name",value:f.name,onValueChange:e=>{b(s=>({...s,name:e,slug:p?s.slug:(0,l.Yv)(e,{lower:!0,strict:!0})}))},isRequired:!0,variant:"bordered"}),(0,a.jsx)(o.r,{label:"Bundle Slug",placeholder:"bundle-name-slug",value:f.slug,onValueChange:e=>b({...f,slug:(0,l.Yv)(e,{lower:!0,strict:!0})}),isRequired:!0,variant:"bordered",description:"URL-friendly version (lowercase, hyphens only)"}),(0,a.jsx)(o.r,{label:"Meta Title",placeholder:"SEO title",value:f.meta_title,onValueChange:e=>b({...f,meta_title:e}),variant:"bordered"}),(0,a.jsx)(d.P,{label:"Meta Description",placeholder:"Brief SEO description",value:f.meta_description,onValueChange:e=>b({...f,meta_description:e}),variant:"bordered",minRows:3}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("label",{className:"text-sm font-medium",children:["Bundle Image"," ",!p&&(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let s=e.target.files[0];s&&(b(e=>({...e,image:s})),y(URL.createObjectURL(s)))},className:"text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),v&&(0,a.jsx)("img",{src:v,className:"w-32 h-32 object-cover rounded-lg border-2",alt:"Preview"})]})]})}),(0,a.jsxs)(u.q,{children:[(0,a.jsx)(m.T,{color:"danger",variant:"light",onPress:t,children:"Cancel"}),(0,a.jsx)(m.T,{color:"primary",onPress:()=>{x(f)},isLoading:g,children:p?"Update Bundle":"Create Bundle"})]})]})})};function p(e){let{isOpen:s,onClose:t,onConfirm:l,title:o="Confirm Action",message:d="Are you sure you want to proceed? This action cannot be undone.",confirmText:h="Confirm",cancelText:x="Cancel",confirmColor:p="danger",isLoading:g=!1,itemName:j}=e,f=async()=>{await l()};return(0,a.jsx)(n.Y,{isOpen:s,onClose:t,children:(0,a.jsxs)(i.g,{children:[(0,a.jsx)(r.c,{children:o}),(0,a.jsx)(c.h,{children:"string"==typeof d?(0,a.jsxs)("p",{children:[d,j&&(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)("strong",{children:j}),"?"]})]}):d}),(0,a.jsxs)(u.q,{children:[(0,a.jsx)(m.T,{variant:"light",onPress:t,isDisabled:g,children:x}),(0,a.jsx)(m.T,{color:p,onPress:f,isLoading:g,children:h})]})]})})}var g=t(72495),j=t(53454),f=t(18850),b=t(75813),v=t(40752),y=t(63162),N=t(1567),w=t(93467),C=t(22708),k=t(30086),_=t(53773),B=t(95604),A=t(58451),E=t(64177),T=t(33183),L=t(35169),O=t(13717),S=t(62525),U=t(37108),D=t(71007),z=t(69074),F=t(35695);function P(e){var s,t;let{bundle:l}=e,n=(0,F.useRouter)(),[i,r]=(0,h.useTransition)(),{isOpen:c,onOpen:o,onClose:d}=(0,f.j)(),{isOpen:u,onOpen:P,onClose:R}=(0,f.j)(),[M,Y]=(0,h.useState)(!1),[$,I]=(0,h.useState)(!1),V="https://api.embroidize.com/api/v1",W=()=>{var e;return null==(e=document.cookie.split("; ").find(e=>e.startsWith("token=")))?void 0:e.split("=")[1]},q=async e=>{I(!0);try{let s=W(),t=new FormData;t.append("name",e.name),t.append("slug",e.slug),t.append("meta_title",e.meta_title||""),t.append("meta_description",e.meta_description||""),e.image instanceof File&&t.append("image",e.image);let a=await fetch("".concat(V,"/bundles/").concat(l._id),{method:"PATCH",headers:{Authorization:"Bearer ".concat(s)},body:t}),i=await a.json();if(!a.ok)throw Error(i.message||"Update failed");(0,j.r)("Success","Bundle updated successfully",3e3),r(()=>{n.refresh(),R()})}catch(e){(0,g.Q)("Error",e.message||"Action Failed",3e3)}finally{I(!1)}},Z=async()=>{Y(!0);try{let e=W();if((await fetch("".concat(V,"/admin/bundle/").concat(l._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).ok)toast.success("Bundle deleted successfully"),n.push("/admin/bundle-products"),n.refresh();else throw Error("Failed to delete")}catch(e){toast.error(e.message)}finally{Y(!1),d()}},G=l.products.reduce((e,s)=>e+s.price,0);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(m.T,{isIconOnly:!0,variant:"light",onClick:()=>n.back(),children:(0,a.jsx)(L.A,{size:20})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Bundle Details"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(m.T,{color:"primary",variant:"flat",startContent:(0,a.jsx)(O.A,{size:18}),onClick:P,children:"Edit"}),(0,a.jsx)(m.T,{color:"danger",variant:"flat",startContent:(0,a.jsx)(S.A,{size:18}),onClick:o,children:"Delete"})]})]}),(0,a.jsx)(v.Z,{children:(0,a.jsx)(y.d,{className:"flex-col items-start gap-2 px-6",children:(0,a.jsxs)("div",{className:"flex w-full items-start gap-6",children:[(0,a.jsx)(b.W,{src:null==(s=l.image)?void 0:s.url,alt:l.name,width:200,height:200,className:"rounded-lg "}),(0,a.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold capitalize",children:l.name}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(U.A,{size:18,className:"text-gray-500"}),(0,a.jsxs)("span",{className:"text-sm",children:[l.products.length," Products"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(D.A,{size:18,className:"text-gray-500"}),(0,a.jsx)("span",{className:"text-sm",children:(null==(t=l.createdBy)?void 0:t.name)||"Unknown"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(z.A,{size:18,className:"text-gray-500"}),(0,a.jsx)("span",{className:"text-sm",children:new Date(l.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),(0,a.jsx)(N.y,{}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Total Value:"}),(0,a.jsxs)(w.R,{color:"success",variant:"flat",size:"lg",children:["$",G.toFixed(2)]})]})]})]})})}),(0,a.jsxs)(v.Z,{children:[(0,a.jsx)(y.d,{className:"px-6",children:(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Bundle Products"})}),(0,a.jsx)(C.U,{className:"px-6",children:(0,a.jsxs)(k.j,{"aria-label":"Bundle products table",children:[(0,a.jsx)(_.X,{columns:[{name:"IMAGE",uid:"image"},{name:"NAME",uid:"name"},{name:"CATEGORY",uid:"category"},{name:"SUB CATEGORY",uid:"sub_category"},{name:"PRICE",uid:"price"},{name:"SKU",uid:"sku_code"}],children:e=>(0,a.jsx)(B.e,{children:e.name},e.uid)}),(0,a.jsx)(A.E,{items:l.products,children:e=>(0,a.jsx)(E.s,{children:s=>(0,a.jsx)(T.w,{children:((e,s)=>{var t,l,n;switch(s){case"image":return(0,a.jsx)(b.W,{src:(null==(t=e.image)?void 0:t.url)||"/placeholder.png",alt:e.name,width:50,height:50,className:"rounded-md"});case"name":return(0,a.jsx)("span",{className:"font-medium",children:e.name});case"category":return(null==(l=e.category)?void 0:l.name)||"N/A";case"sub_category":return(null==(n=e.sub_category)?void 0:n.name)||"N/A";case"price":return"$".concat(e.price.toFixed(2));case"sku_code":return e.sku_code||"N/A";default:return e[s]}})(e,s)})},e._id)})]})})]})]}),(0,a.jsx)(x,{isOpen:u,onClose:R,initialData:l,onSubmit:q,isLoading:$}),(0,a.jsx)(p,{isOpen:c,onClose:d,onConfirm:Z,title:"Delete Bundle",message:"Are you sure you want to delete",itemName:l.name,confirmText:"Delete",cancelText:"Cancel",confirmColor:"danger",isLoading:M})]})}}},e=>{e.O(0,[9234,640,8355,8793,6057,6501,418,9858,8254,8703,9699,1310,5383,5150,8441,5964,7358],()=>e(e.s=47332)),_N_E=e.O()}]);