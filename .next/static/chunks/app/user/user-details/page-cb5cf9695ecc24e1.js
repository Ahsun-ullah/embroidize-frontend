(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9401],{29879:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});var a=t(95155),l=t(9234);let r=()=>(0,a.jsx)(l.o,{color:"white",className:"bg-black p-3 rounded-full"})},45845:(e,s,t)=>{"use strict";t.d(s,{Gq:()=>o,Hd:()=>i,Lv:()=>u,jm:()=>d,nd:()=>m,xM:()=>n,zo:()=>c});var a=t(70404),l=t(76698),r=t(57383);let o=(0,a.xP)({reducerPath:"userInfoSlice",baseQuery:(0,l.cw)({baseUrl:"https://api.embroidize.com/api/v1",prepareHeaders:e=>{let s=r.A.get("token");return s&&e.set("Authorization","Bearer ".concat(s)),e}}),endpoints:e=>({userInfo:e.query({query:()=>({url:"/userinfo",method:"GET"})}),updateUserInfo:e.mutation({query:e=>({url:"/user/".concat(e.get("id")),method:"PUT",body:e})}),updatePassword:e.mutation({query:e=>({url:"/settings/password/",method:"PATCH",body:e})}),forgotPassword:e.mutation({query:e=>({url:"/public/forgot-password",method:"POST",body:e})}),resetPassword:e.mutation({query:e=>({url:"/public/reset-password",method:"POST",body:e})}),UserDownloadHistory:e.query({query:e=>({url:"/downloads/user/".concat(e),method:"GET"})})})}),{useUserInfoQuery:i,useUpdateUserInfoMutation:n,useUserDownloadHistoryQuery:d,useUpdatePasswordMutation:c,useForgotPasswordMutation:m,useResetPasswordMutation:u}=o},53454:(e,s,t)=>{"use strict";t.d(s,{r:()=>o});var a=t(95155),l=t(60418),r=t(29858);let o=(e,s,t)=>(0,l.$U)({title:"".concat(e,"!"),description:"".concat(s),timeout:"".concat(t),color:"success",position:"top-right",shouldShowTimeoutProgress:!0,classNames:{closeButton:"opacity-100 absolute right-4 top-1/2 -translate-y-1/2 ms-8",base:(0,r.cn)(["bg-default-50 dark:bg-background shadow-sm text-black flex"])},closeIcon:(0,a.jsxs)("svg",{fill:"none",height:"32",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"32",children:[(0,a.jsx)("path",{d:"M18 6 6 18"}),(0,a.jsx)("path",{d:"m6 6 12 12"})]})})},72495:(e,s,t)=>{"use strict";t.d(s,{Q:()=>o});var a=t(95155),l=t(60418),r=t(29858);let o=(e,s,t)=>(0,l.$U)({title:"".concat(e,"!"),description:"".concat(s),timeout:"".concat(t||3e3),color:"danger",position:"top-right",shouldShowTimeoutProgress:!0,classNames:{closeButton:"opacity-100 absolute right-4 top-1/2 -translate-y-1/2 ms-8",base:(0,r.cn)(["bg-default-50 dark:bg-background shadow-sm text-black flex"])},closeIcon:(0,a.jsxs)("svg",{fill:"none",height:"32",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"32",children:[(0,a.jsx)("path",{d:"M18 6 6 18"}),(0,a.jsx)("path",{d:"m6 6 12 12"})]})})},73623:(e,s,t)=>{"use strict";t.d(s,{default:()=>j});var a=t(95155),l=t(72495),r=t(29879),o=t(45845),i=t(8009),n=t(85812),d=t(57383),c=t(12115),m=t(53454),u=t(90221),x=t(62177),p=t(70927);let h=p.Ik({current_password:p.Yj().min(6,"Current password is required"),new_password:p.Yj().min(6,"New password must be at least 6 characters")});function f(){let{register:e,handleSubmit:s,formState:{errors:t,isDirty:i},reset:n}=(0,x.mN)({resolver:(0,u.u)(h),defaultValues:{current_password:"",new_password:""}}),[d,{isLoading:p}]=(0,o.zo)(),[f,g]=(0,c.useState)(!1),[w,b]=(0,c.useState)(!1),j=async e=>{try{await d(e).unwrap(),(0,m.r)("Success","Password updated successfully!",3e3),n()}catch(e){var s;(0,l.Q)("Error",(null==(s=e.data)?void 0:s.message)||"Failed to update password",3e3)}};return(0,a.jsxs)("div",{className:"w-full max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Change Password"}),(0,a.jsxs)("form",{onSubmit:s(j),children:[(0,a.jsxs)("div",{className:"mb-4 relative",children:[(0,a.jsx)("label",{className:"block font-medium mb-1",htmlFor:"current_password",children:"Current Password"}),(0,a.jsx)("input",{type:f?"text":"password",id:"current_password",...e("current_password"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 pr-10",placeholder:"Enter current password"}),(0,a.jsx)("button",{type:"button",className:"absolute right-3 top-[32px] text-xl text-gray-500",onClick:()=>g(e=>!e),children:f?(0,a.jsx)("i",{className:"ri-eye-off-fill text-2xl"}):(0,a.jsx)("i",{className:"ri-eye-close-fill text-2xl"})}),t.current_password&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:t.current_password.message})]}),(0,a.jsxs)("div",{className:"mb-6 relative",children:[(0,a.jsx)("label",{className:"block font-medium mb-1",htmlFor:"new_password",children:"New Password"}),(0,a.jsx)("input",{type:w?"text":"password",id:"new_password",...e("new_password"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 pr-10",placeholder:"Enter new password"}),(0,a.jsx)("button",{type:"button",className:"absolute right-3 top-[32px] text-xl text-gray-500",onClick:()=>b(e=>!e),children:w?(0,a.jsx)("i",{className:"ri-eye-off-fill text-2xl"}):(0,a.jsx)("i",{className:"ri-eye-close-fill text-2xl"})}),t.new_password&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:t.new_password.message})]}),(0,a.jsx)("button",{type:"submit",disabled:p||!i,className:"w-full h-10 font-semibold rounded-md transition ".concat(p||!i?"bg-gray-400 cursor-not-allowed":"bg-black text-white hover:bg-blue-500"),children:p?(0,a.jsx)(r.default,{}):"Update Password"})]})]})}var g=t(66766);let w=p.Ik({name:p.Yj().min(2,"Name is required"),email:p.Yj().email("Invalid email"),profile_image:p.bz().optional()});function b(){var e;let{data:s,isLoading:t,error:i,refetch:n}=(0,o.Hd)(),[d,{isLoading:p}]=(0,o.xM)(),[h,f]=(0,c.useState)(null),{register:b,handleSubmit:j,formState:{errors:v,isDirty:N},setValue:y,reset:k,watch:_}=(0,x.mN)({resolver:(0,u.u)(w),defaultValues:{name:"",email:""}}),P=_();(0,c.useEffect)(()=>{if(s){var e,t,a;k({name:null!=(t=s.name)?t:"",email:null!=(a=s.email)?a:""}),(null==(e=s.profile_image)?void 0:e.url)&&f(s.profile_image.url)}},[s,k]);let E=async e=>{if(!N&&!e.profile_image)return void(0,m.r)("Success","No changes to save",3e3);let t=new FormData;t.append("name",e.name),t.append("email",e.email),t.append("id",null==s?void 0:s._id),e.profile_image&&e.profile_image[0]&&t.append("profile_image",e.profile_image[0]);try{await d(t).unwrap(),n(),(0,m.r)("Success","Profile updated successfully!",3e3)}catch(e){var a;(0,l.Q)("Error",(null==(a=e.data)?void 0:a.message)||"Failed to update profile",3e3)}};return t?(0,a.jsx)("div",{className:"flex justify-center items-center",children:(0,a.jsx)(r.default,{})}):i?(0,a.jsx)("div",{className:"text-center text-red-500 p-4",children:"Failed to load profile data. Please try again."}):(0,a.jsxs)("div",{className:"w-full max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Profile Details"}),(0,a.jsxs)("form",{onSubmit:j(E),children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center mb-8",children:[(0,a.jsx)("div",{className:"relative mb-4 sm:mb-0",children:(0,a.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-100",children:(0,a.jsx)(g.default,{src:h||(null==s||null==(e=s.profile_image)?void 0:e.url)||"/images.jpg",alt:"Profile",width:96,height:96,className:"object-cover w-full h-full",onError:e=>{e.target.src="/images.jpg"}})})}),(0,a.jsxs)("div",{className:"ml-0 sm:ml-4",children:[(0,a.jsxs)("div",{className:"relative w-40 h-10 bg-gray-100 text-center text-sm font-medium rounded-lg overflow-hidden cursor-pointer hover:bg-gray-200 transition",children:[(0,a.jsx)("span",{className:"absolute inset-0 flex items-center justify-center z-10",children:"Change Photo"}),(0,a.jsx)("input",{type:"file",accept:"image/jpeg,image/png,image/gif",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20",onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t){if(!["image/jpeg","image/png","image/gif"].includes(t.type)){(0,l.Q)("Error","Please select a valid image file (JPEG, PNG, or GIF)",3e3),e.target.value="";return}if(t.size>5242880){(0,l.Q)("Error","Image size should be less than 5MB",3e3),e.target.value="";return}y("profile_image",e.target.files,{shouldDirty:!0}),f(URL.createObjectURL(t))}}})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"JPEG, PNG or GIF (max. 5MB)"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block font-medium mb-1",htmlFor:"name",children:"Full Name"}),(0,a.jsx)("input",{...b("name"),id:"name",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your full name"}),v.name&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v.name.message})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block font-medium mb-1",htmlFor:"email",children:"Email"}),(0,a.jsx)("input",{...b("email"),id:"email",type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your email"}),v.email&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v.email.message})]}),(0,a.jsx)("button",{type:"submit",disabled:p||!N&&!P.profile_image,className:"w-full h-10 font-semibold rounded-md transition ".concat(!p&&(N||P.profile_image)?"bg-black text-white hover:bg-blue-500":"bg-gray-400 cursor-not-allowed"),children:p?(0,a.jsx)(r.default,{}):"Update Profile"})]})]})}function j(e){let{defaultTab:s="account"}=e,[t,m]=(0,c.useState)(s),[u,x]=(0,c.useState)(null),{data:p}=(0,o.Hd)(),h=null==p?void 0:p._id,{data:g,isLoading:w}=(0,o.jm)(h,{skip:!h});(0,c.useEffect)(()=>{s&&m(s)},[s]);let j=async e=>{let{id:s,extension:t}=e,a=d.A.get("token"),r=new Headers;a&&r.set("Authorization","Bearer ".concat(a));try{x(s);let e=await fetch("".concat("https://api.embroidize.com/api/v1","/redownload/product/").concat(s,"/extension/").concat(t),{method:"GET",headers:r});if(!e.ok)throw Error("Download failed with status ".concat(e.status));let a=await e.blob(),l=window.URL.createObjectURL(a),o=document.createElement("a");o.href=l,o.download="From_Embroid_".concat(t,".zip"),document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(l),document.body.removeChild(o)}catch(e){console.error("Download error:",e),(0,l.Q)("Download Failed",(null==e?void 0:e.message)||"Could not download file",3e3)}finally{x(null)}},v=e=>{var s,t;let{_id:l,downloadedAt:o,fileType:i,product:n,user:d}=e,c=null!=(t=null==n||null==(s=n.image)?void 0:s.url)?t:"/fallback-image.png";return(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 bg-white shadow-md rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex flex-1 items-start gap-4 sm:text-xs sm:gap-2",children:[(0,a.jsx)("img",{src:c,alt:(null==n?void 0:n.name)||"Design",className:"w-20 h-20 object-cover rounded"}),(0,a.jsxs)("div",{className:"flex flex-col justify-between sm:text-xs sm:gap-2",children:[(0,a.jsx)("h3",{className:"text-base font-semibold text-gray-800 sm:text-xs sm:gap-2",children:null==n?void 0:n.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500 text-wrap sm:text-xs sm:gap-2",children:null==d?void 0:d.name}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-gray-500",children:["File: ",(0,a.jsx)("span",{className:"uppercase",children:i})]})]})]}),(0,a.jsxs)("div",{className:"flex sm:flex-row sm:items-center justify-between sm:w-1/2",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500 flex items-center",children:new Date(o).toISOString().split("T")[0]}),(0,a.jsx)("div",{className:"flex justify-end",children:u===(null==n?void 0:n._id)?(0,a.jsx)(r.default,{}):(0,a.jsxs)("button",{onClick:()=>j({extension:i,id:null==n?void 0:n._id}),className:"button",disabled:!!u,children:[(0,a.jsx)("i",{className:"ri-download-fill"})," Download"]})})]})]},l)},N=(0,c.useMemo)(()=>{var e;return w?(0,a.jsx)(r.default,{}):(null==g||null==(e=g.data)?void 0:e.length)===0?(0,a.jsx)("p",{className:"text-center",children:"No downloads data found."}):(0,a.jsxs)("div",{className:"max-w-5xl mx-auto p-4 sm:p-6 bg-blue-50 rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"hidden sm:flex justify-between text-sm text-gray-500 uppercase mb-3",children:[(0,a.jsx)("h2",{children:"Details"}),(0,a.jsx)("h2",{children:"Date"}),(0,a.jsx)("h2",{children:"Actions"})]}),null==g?void 0:g.data.map(v)]})},[g,u]);return(0,a.jsxs)("div",{className:"py-10",children:[(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsxs)(i.r,{"aria-label":"User Tabs",selectedKey:t,onSelectionChange:m,color:"secondary",variant:"bordered",size:"sm",placement:"top",className:"bg-white !border-black",children:[(0,a.jsx)(n.i,{title:(0,a.jsxs)("div",{className:"flex items-center justify-start space-x-2 text-xs md:text-xl ".concat("account"===t?"text-white":"text-black"),children:[(0,a.jsx)("i",{className:"ri-account-circle-fill"}),(0,a.jsx)("span",{children:"Account"})]})},"account"),(0,a.jsx)(n.i,{title:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-xs md:text-xl ".concat("password"===t?"text-white":"text-black"),children:[(0,a.jsx)("i",{className:"ri-lock-password-fill"}),(0,a.jsx)("span",{children:"Change Password"})]})},"password"),(0,a.jsx)(n.i,{title:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-xs md:text-xl ".concat("downloads"===t?"text-white":"text-black"),children:[(0,a.jsx)("i",{className:"ri-download-fill"}),(0,a.jsx)("span",{children:"Downloads"})]})},"downloads")]})}),(0,a.jsxs)("div",{className:"w-full px-4 sm:px-6 mt-6",children:["account"===t&&(0,a.jsx)(b,{}),"downloads"===t&&N,"password"===t&&(0,a.jsx)(f,{})]})]})}},98056:(e,s,t)=>{Promise.resolve().then(t.bind(t,73623))}},e=>{e.O(0,[9234,640,8793,4710,5014,6766,6501,418,9858,8254,6687,9683,3441,9662,7841,8441,5964,7358],()=>e(e.s=98056)),_N_E=e.O()}]);